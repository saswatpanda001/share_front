{"ast":null,"code":"import _slicedToArray from\"/home/saswat/Documents/Django/Shareme/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import AxiosRequest from'../../axios';import{DecodeToken}from'../token_decode';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Call=function Call(){var _useState=useState({user_id:null,username:null,ws_api:null}),_useState2=_slicedToArray(_useState,2),socketDetails=_useState2[0],setSocketDetails=_useState2[1];var videoReference=useRef();var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var video_id=window.location.pathname.slice(13);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),messageData=_useState6[0],setMessageData=_useState6[1];if(socketDetails.videoWebSocket){socketDetails.videoWebSocket.onopen=function(){console.log(\"connection established\");};socketDetails.videoWebSocket.onclose=function(){console.log(\"disconnected\");};socketDetails.videoWebSocket.onmessage=function(res){if(res.data){console.log(res);}};}var handleMessages=function handleMessages(){messageData.push(message);console.log(message);socketDetails.videoWebSocket.send(JSON.stringify({\"data\":message,\"code\":video_id,\"type\":\"send\"}));};var getVideo=function getVideo(){navigator.mediaDevices.getUserMedia({video:{width:500,height:350},audio:true}).then(function(dataStream){console.log(dataStream);var video=videoReference.current;video.srcObject=dataStream;video.play();}).catch(function(err){console.error(\"error:\",err);});};useEffect(function(){var user_id=DecodeToken(localStorage.getItem(\"access_token\")).user_id;var username=DecodeToken(localStorage.getItem(\"access_token\")).username;var ws_api=new WebSocket(\"ws://localhost:8000/ws/call/\".concat(window.location.pathname.slice(14)));getVideo();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container mb-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-center mb-5 mt-5\",style:{fontSize:\"35px\"},children:\"Video Call\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-5 mb-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mr-3 ml-3 d-flex mb-5\",style:{gap:\"20px\"},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",children:\"Audio Off\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",children:\"Video Off\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"input\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",children:\"Join Room\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex mt-5\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){setMessage(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",onClick:handleMessages,children:\"Send Message\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-7 mb-5\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoReference})})]})]});};export default Call;","map":{"version":3,"sources":["/home/saswat/Documents/Django/Shareme/frontend/src/Components/chat/Call.js"],"names":["React","useState","useEffect","useRef","AxiosRequest","DecodeToken","Call","user_id","username","ws_api","socketDetails","setSocketDetails","videoReference","message","setMessage","video_id","window","location","pathname","slice","messageData","setMessageData","videoWebSocket","onopen","console","log","onclose","onmessage","res","data","handleMessages","push","send","JSON","stringify","getVideo","navigator","mediaDevices","getUserMedia","video","width","height","audio","then","dataStream","current","srcObject","play","catch","err","error","localStorage","getItem","WebSocket","fontSize","gap","e","target","value"],"mappings":"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","sourcesContent":["import React,{useState,useEffect,useRef} from 'react'\nimport AxiosRequest from '../../axios'\nimport { DecodeToken } from '../token_decode'\n\n\n\n\n\n\nconst Call = () => {\n\n  const [socketDetails,setSocketDetails] = useState({user_id:null,username:null,ws_api:null})\n    const videoReference= useRef()\n\n    const [message,setMessage] = useState([])\n    const video_id = window.location.pathname.slice(13)\n    const [messageData,setMessageData] = useState([])\n\n    if(socketDetails.videoWebSocket){\n\n      socketDetails.videoWebSocket.onopen = () => {console.log(\"connection established\")}\n      socketDetails.videoWebSocket.onclose = () => {console.log(\"disconnected\")}\n\n      socketDetails.videoWebSocket.onmessage = (res) => {\n        if(res.data){\n            console.log(res)\n            \n        }\n    }}\n\n    const handleMessages = () => {\n        messageData.push(message)\n        console.log(message)\n        socketDetails.videoWebSocket.send(JSON.stringify({\"data\":message,\"code\":video_id,\"type\":\"send\"}))\n    }\n\n    const getVideo = () => {\n        navigator.mediaDevices.getUserMedia({ video: { width:500,height:350 },audio:true })\n          .then((dataStream) => {\n            console.log(dataStream)\n            let video = videoReference.current;\n            video.srcObject = dataStream;\n            video.play()\n          })\n          .catch(err => {\n            console.error(\"error:\", err);\n          });\n      };\n\n      useEffect(() => {\n          const user_id = DecodeToken(localStorage.getItem(\"access_token\")).user_id\n          const username = DecodeToken(localStorage.getItem(\"access_token\")).username\n          const ws_api = new WebSocket(`ws://localhost:8000/ws/call/${window.location.pathname.slice(14)}`);\n          getVideo();\n      }, [])\n      \n\n\n\n\n\n    return (\n    <div className='container mb-3'>\n        <p className='text-center mb-5 mt-5' style={{fontSize:\"35px\"}}>Video Call</p>\n        <div className='row'>\n\n        <div className='col-md-5 mb-5'>\n        <div className='mr-3 ml-3 d-flex mb-5' style={{gap:\"20px\"}}>\n       \n        <button className='btn btn-dark'>Audio Off</button>\n        <button className='btn btn-dark'>Video Off</button>\n        </div>\n        <div className='d-flex'>\n        <input></input>\n        <button className='btn btn-dark'>Join Room</button>\n        </div>\n\n        <div className='d-flex mt-5'>\n        <input onChange={(e) => {setMessage(e.target.value)}}></input>\n        <button className='btn btn-dark' onClick={handleMessages}>Send Message</button>\n        </div>\n        </div>\n        \n\n        <div className='col-md-7 mb-5'>\n         <video ref={videoReference} ></video>\n        </div>\n\n\n        </div>\n       \n\n    </div>\n  )\n}\n\nexport default Call"]},"metadata":{},"sourceType":"module"}