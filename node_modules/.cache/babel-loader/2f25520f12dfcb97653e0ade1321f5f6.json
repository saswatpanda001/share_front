{"ast":null,"code":"import _regeneratorRuntime from\"/home/saswat/Documents/Django/Shareme/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/saswat/Documents/Django/Shareme/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/saswat/Documents/Django/Shareme/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{DecodeToken}from'../token_decode';import AxiosRequest from'../../axios';import CartProductRecommendation from'./CartProductRecommendation';import{useNavigate}from'react-router';import{Axios}from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CartDetails=function CartDetails(){var navigate=useNavigate();var user_id=DecodeToken(localStorage.getItem(\"access_token\")).user_id;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cartData=_useState2[0],setCartData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),category=_useState4[0],setCategory=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),productRecommendation=_useState6[0],setProductRecommendation=_useState6[1];var calculateNetPrice=function calculateNetPrice(){var totalAmount=0;for(var i=0;i<cartData.length;i++){totalAmount+=parseInt(cartData[i].net_price);}return totalAmount;};var retrieveCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var cartProducts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return AxiosRequest.get(\"/shareme/cart/\".concat(user_id)).then(function(res){setCartData(res.data);retrieveRecommendation();}).catch(function(err){console.log(err);});case 2:cartProducts=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function retrieveCart(){return _ref.apply(this,arguments);};}();var retrieveRecommendation=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var recProducts;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return AxiosRequest.post(\"/shareme/posts/recommend\",{user_id:user_id}).then(function(res){setProductRecommendation(res.data);}).catch(function(err){console.log(err);});case 2:recProducts=_context2.sent;case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function retrieveRecommendation(){return _ref2.apply(this,arguments);};}();// const handleQuantity = async(id,price) => {\n//     const setQuantity = await AxiosRequest.put(`/shareme/cart/${id}`,{\"quantity\":quantity,\"net_price\":price})\n//                         .then((res) => {retrieveCart();})\n//                         .catch((err) => {console.log(err)})\n// }\nvar saveLaterHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id,del_id){var addToSave;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return AxiosRequest.post(\"shareme/savelater/\".concat(id),{\"buyer\":user_id,\"id\":id}).then(function(res){return console.log(res);}).catch(function(err){return console.log(err);});case 2:addToSave=_context3.sent;deleteCartItem(del_id);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function saveLaterHandler(_x,_x2){return _ref3.apply(this,arguments);};}();var deleteCartItem=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){var deleteCartItem;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return AxiosRequest.delete(\"/shareme/cart/\".concat(id)).then(function(res){retrieveCart();}).catch(function(err){console.log(err);});case 2:deleteCartItem=_context4.sent;case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function deleteCartItem(_x3){return _ref4.apply(this,arguments);};}();var handleOrder=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var passOrder;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return AxiosRequest.post(\"/sales/orders/\".concat(user_id),cartData).then(function(res){console.log(res);}).catch(function(err){console.log(err);});case 2:passOrder=_context5.sent;navigate(\"/shareme/orders/\".concat(user_id));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function handleOrder(){return _ref5.apply(this,arguments);};}();var RenderCartData=cartData.map(function(each){console.log(each);return/*#__PURE__*/_jsx(\"div\",{className:\"lg:ml-3 mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8000\".concat(each.image),className:\"w-25\",onClick:function onClick(){return navigate(\"/shareme/posts/\".concat(each.product));}})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"23px\",textAlign:\"left\"},className:\"lead\",children:each.title}),/*#__PURE__*/_jsx(\"i\",{className:\"large red close icon\",onClick:function onClick(){return deleteCartItem(each.id);}}),/*#__PURE__*/_jsx(\"i\",{className:\"large red save icon\",onClick:function onClick(){return saveLaterHandler(each.product,each.id);}}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"16px\"},children:[\" Quantity: \",each.quantity]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"16px\"},children:[\"NetPrice: \",each.net_price]})]})]})},each.id);});useEffect(function(){retrieveCart();calculateNetPrice();},[]);return/*#__PURE__*/_jsxs(\"div\",{align:\"center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"lg:text-4xl mt-3 mb-3 lg:ml-3 text-left\",children:\"Shopping Bag\"}),RenderCartData]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3\",style:{textAlign:\"left\",marginLeft:\"25px\",marginTop:\"25px\"},children:[/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"22px\"},children:[\"Total Quantity: \",cartData.length]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"22px\"},children:[\"Total Amount: \",calculateNetPrice(),\" \"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",onClick:handleOrder,children:\" Place you order\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CartProductRecommendation,{props:productRecommendation})})]});};export default CartDetails;","map":{"version":3,"sources":["/home/saswat/Documents/Django/Shareme/frontend/src/Components/Cart/CartDetails.js"],"names":["React","useState","useEffect","DecodeToken","AxiosRequest","CartProductRecommendation","useNavigate","Axios","CartDetails","navigate","user_id","localStorage","getItem","cartData","setCartData","category","setCategory","productRecommendation","setProductRecommendation","calculateNetPrice","totalAmount","i","length","parseInt","net_price","retrieveCart","get","then","res","data","retrieveRecommendation","catch","err","console","log","cartProducts","post","recProducts","saveLaterHandler","id","del_id","addToSave","deleteCartItem","delete","handleOrder","passOrder","RenderCartData","map","each","image","product","fontSize","textAlign","title","quantity","marginLeft","marginTop"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react'\nimport { DecodeToken } from '../token_decode'\nimport AxiosRequest from '../../axios'\nimport CartProductRecommendation from './CartProductRecommendation'\nimport { useNavigate } from 'react-router'\nimport { Axios } from 'axios'\n\n\nconst CartDetails = () => {\n    const navigate = useNavigate()\n    const user_id = DecodeToken(localStorage.getItem(\"access_token\")).user_id;\n    const [cartData,setCartData] = useState([])\n    const [category,setCategory] = useState([])\n    const [productRecommendation,setProductRecommendation] = useState([])\n   \n\n\n    const calculateNetPrice = () => {\n        let totalAmount = 0\n        for(let i=0;i<cartData.length;i++){\n            totalAmount += (parseInt(cartData[i].net_price))\n        }\n        \n        return totalAmount;\n    }\n\n\n    \n    \n    \n    \n\n\n    \n    const retrieveCart = async() => {\n        const cartProducts = await AxiosRequest.get(`/shareme/cart/${user_id}`)\n                            .then((res) => {\n                                setCartData(res.data)\n                                retrieveRecommendation();\n                            })\n                            .catch((err) => {console.log(err)})        \n    }\n\n\n    const retrieveRecommendation = async() => {\n            const recProducts = await AxiosRequest.post(\"/shareme/posts/recommend\",{user_id})\n                            .then((res) => {\n                                setProductRecommendation(res.data)    \n                            })\n                            .catch((err) => {console.log(err)})\n    }\n\n\n\n        // const handleQuantity = async(id,price) => {\n        //     const setQuantity = await AxiosRequest.put(`/shareme/cart/${id}`,{\"quantity\":quantity,\"net_price\":price})\n        //                         .then((res) => {retrieveCart();})\n        //                         .catch((err) => {console.log(err)})\n        // }\n\n    const saveLaterHandler = async(id,del_id) => {\n        const addToSave =await AxiosRequest.post(`shareme/savelater/${id}`,{\"buyer\":user_id,\"id\":id})\n                        .then((res) => console.log(res))\n                        .catch((err) => console.log(err))\n\n        deleteCartItem(del_id);\n    }\n\n\n    const deleteCartItem = async(id) => {\n            const deleteCartItem = await AxiosRequest.delete(`/shareme/cart/${id}`)\n                                .then((res) => {\n                                    retrieveCart();\n                                })\n                                .catch((err) => {console.log(err)})\n    }\n\n\n    const handleOrder = async() => {\n            const passOrder = await AxiosRequest.post(`/sales/orders/${user_id}`,cartData)\n                            .then((res) => {console.log(res);})\n                            .catch((err) => {console.log(err)})\n            navigate(`/shareme/orders/${user_id}`)\n    }\n    \n\n    const RenderCartData = cartData.map((each) => { \n            console.log(each)\n\n            \n            return(            \n                <div className='lg:ml-3 mt-4' key={each.id} >\n                    <div className='d-flex' >\n\n                    <div>\n                    <img src={`http://localhost:8000${each.image}`} className=\"w-25\" onClick={() => navigate(`/shareme/posts/${each.product}`)}></img>\n                    </div>\n\n\n                    <div>\n                    <p style={{fontSize:\"23px\",textAlign:\"left\"}} className='lead'>{each.title}</p>\n                    \n                    <i className='large red close icon' onClick={() => deleteCartItem(each.id)}></i>\n                    <i className='large red save icon' onClick={() => saveLaterHandler(each.product,each.id)}></i>\n                    <p style={{fontSize:\"16px\"}}> Quantity: {each.quantity}</p>\n                    <p style={{fontSize:\"16px\"}}>NetPrice: {each.net_price}</p>\n\n\n                    </div>\n                    </div>\n                   \n                </div>            \n            );\n    })\n\n\n    useEffect(() => {\n      retrieveCart();\n      calculateNetPrice();\n    }, [])\n\n\n    return (\n    <div align=\"center\">\n       \n        <div className='container row'>\n\n\n        <div className='col-md-8'>\n        <p className='lg:text-4xl mt-3 mb-3 lg:ml-3 text-left'>Shopping Bag</p>\n        {RenderCartData}\n        </div>\n\n\n        <div className='col-md-3' style={{textAlign:\"left\", marginLeft:\"25px\", marginTop:\"25px\"}} >\n\n            <p style={{fontSize:\"22px\"}}>Total Quantity: {cartData.length}</p>\n            <p style={{fontSize:\"22px\"}}>Total Amount: {calculateNetPrice()} </p>\n            <button className='btn btn-dark' onClick={handleOrder}> Place you order</button>\n        </div>\n        </div>\n\n        <div>\n            <CartProductRecommendation props={productRecommendation}/>\n        </div>\n\n    </div>\n  )\n}\n\nexport default CartDetails;\n"]},"metadata":{},"sourceType":"module"}